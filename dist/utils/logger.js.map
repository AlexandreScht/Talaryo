{"version":3,"sources":["../../src/utils/logger.ts"],"sourcesContent":["import config from '@config';\nimport chalk from 'chalk'; // Importez chalk pour la coloration de la console\nimport { existsSync, mkdirSync } from 'fs';\nimport { join } from 'path';\nimport winston from 'winston';\nimport winstonDaily from 'winston-daily-rotate-file';\n\nconst { log } = config;\n// logs dir\nconst logDir: string = join(__dirname, log.DIR);\n\nif (!existsSync(logDir)) {\n  mkdirSync(logDir);\n}\n\n// Define log format\nconst logFormat = winston.format.printf(({ timestamp, level, message }) => `${timestamp} ${level}: ${message}`);\n\n/*\n * Log Level\n * error: 0, warn: 1, info: 2, http: 3, verbose: 4, debug: 5, silly: 6\n */\nconst logger = winston.createLogger({\n  format: winston.format.combine(\n    winston.format.timestamp({\n      format: 'YYYY-MM-DD HH:mm:ss',\n    }),\n    logFormat,\n  ),\n  transports: [\n    // debug log setting\n    new winstonDaily({\n      level: 'debug',\n      datePattern: 'YYYY-MM-DD',\n      dirname: logDir + '/debug', // dir log file -> /logs/debug/*.log\n      filename: `%DATE%.log`,\n      maxFiles: 30, // 30 Days saved\n      json: false,\n      zippedArchive: true,\n    }),\n    // error log setting\n    new winstonDaily({\n      level: 'error',\n      datePattern: 'YYYY-MM-DD',\n      dirname: logDir + '/error', // dir log file -> /logs/error/*.log\n      filename: `%DATE%.log`,\n      maxFiles: 30, // 30 Days saved\n      handleExceptions: true,\n      json: false,\n      zippedArchive: true,\n    }),\n    // Console parts\n    new winston.transports.Console({\n      format: winston.format.combine(\n        winston.format.colorize(),\n        winston.format(info => {\n          info[Symbol.for('message')] = `${chalk[info.level === 'sql' ? 'blueBright' : 'yellow']('-'.repeat(process.stdout.columns))} [${chalk[\n            info.level === 'sql' ? 'whiteBright' : 'red'\n          ](info.level)}] ${chalk[info.level === 'sql' ? 'cyanBright' : 'blueBright'](info.message)}`;\n\n          return info;\n        })(),\n      ),\n    }),\n  ],\n});\n\nconst stream = {\n  write: (message: string) => {\n    logger.info(message.substring(0, message.lastIndexOf('\\n')));\n  },\n};\n\nexport { logger, stream };\n"],"names":["logger","stream","log","config","logDir","join","__dirname","DIR","existsSync","mkdirSync","logFormat","winston","format","printf","timestamp","level","message","createLogger","combine","transports","winstonDaily","datePattern","dirname","filename","maxFiles","json","zippedArchive","handleExceptions","Console","colorize","info","Symbol","for","chalk","repeat","process","stdout","columns","write","substring","lastIndexOf"],"mappings":";;;;;;;;;;;IAyESA,MAAM;eAANA;;IAAQC,MAAM;eAANA;;;+DAzEE;8DACD;oBACoB;sBACjB;gEACD;+EACK;;;;;;AAEzB,MAAM,EAAEC,GAAG,EAAE,GAAGC,eAAM;AACtB,WAAW;AACX,MAAMC,SAAiBC,IAAAA,UAAI,EAACC,WAAWJ,IAAIK,GAAG;AAE9C,IAAI,CAACC,IAAAA,cAAU,EAACJ,SAAS;IACvBK,IAAAA,aAAS,EAACL;AACZ;AAEA,oBAAoB;AACpB,MAAMM,YAAYC,gBAAO,CAACC,MAAM,CAACC,MAAM,CAAC,CAAC,EAAEC,SAAS,EAAEC,KAAK,EAAEC,OAAO,EAAE,GAAK,CAAC,EAAEF,UAAU,CAAC,EAAEC,MAAM,EAAE,EAAEC,QAAQ,CAAC;AAE9G;;;CAGC,GACD,MAAMhB,SAASW,gBAAO,CAACM,YAAY,CAAC;IAClCL,QAAQD,gBAAO,CAACC,MAAM,CAACM,OAAO,CAC5BP,gBAAO,CAACC,MAAM,CAACE,SAAS,CAAC;QACvBF,QAAQ;IACV,IACAF;IAEFS,YAAY;QACV,oBAAoB;QACpB,IAAIC,+BAAY,CAAC;YACfL,OAAO;YACPM,aAAa;YACbC,SAASlB,SAAS;YAClBmB,UAAU,CAAC,UAAU,CAAC;YACtBC,UAAU;YACVC,MAAM;YACNC,eAAe;QACjB;QACA,oBAAoB;QACpB,IAAIN,+BAAY,CAAC;YACfL,OAAO;YACPM,aAAa;YACbC,SAASlB,SAAS;YAClBmB,UAAU,CAAC,UAAU,CAAC;YACtBC,UAAU;YACVG,kBAAkB;YAClBF,MAAM;YACNC,eAAe;QACjB;QACA,gBAAgB;QAChB,IAAIf,gBAAO,CAACQ,UAAU,CAACS,OAAO,CAAC;YAC7BhB,QAAQD,gBAAO,CAACC,MAAM,CAACM,OAAO,CAC5BP,gBAAO,CAACC,MAAM,CAACiB,QAAQ,IACvBlB,gBAAO,CAACC,MAAM,CAACkB,CAAAA;gBACbA,IAAI,CAACC,OAAOC,GAAG,CAAC,WAAW,GAAG,CAAC,EAAEC,cAAK,CAACH,KAAKf,KAAK,KAAK,QAAQ,eAAe,SAAS,CAAC,IAAImB,MAAM,CAACC,QAAQC,MAAM,CAACC,OAAO,GAAG,EAAE,EAAEJ,cAAK,CAClIH,KAAKf,KAAK,KAAK,QAAQ,gBAAgB,MACxC,CAACe,KAAKf,KAAK,EAAE,EAAE,EAAEkB,cAAK,CAACH,KAAKf,KAAK,KAAK,QAAQ,eAAe,aAAa,CAACe,KAAKd,OAAO,EAAE,CAAC;gBAE3F,OAAOc;YACT;QAEJ;KACD;AACH;AAEA,MAAM7B,SAAS;IACbqC,OAAO,CAACtB;QACNhB,OAAO8B,IAAI,CAACd,QAAQuB,SAAS,CAAC,GAAGvB,QAAQwB,WAAW,CAAC;IACvD;AACF"}