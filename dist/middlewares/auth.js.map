{"version":3,"sources":["../../src/middlewares/auth.ts"],"sourcesContent":["import { ExpiredSessionError, InvalidAccessError } from '@exceptions';\nimport type { ctx } from '@interfaces/request';\n\nconst auth = (role?: string | string[]) => {\n  return async (ctx: ctx) => {\n    const { next, session } = ctx;\n\n    if (!session?.sessionId) {\n      throw new ExpiredSessionError();\n    }\n\n    if (role && session.sessionRole !== role && !role.includes(session.sessionRole)) {\n      throw new InvalidAccessError();\n    }\n\n    next();\n  };\n};\n\nexport default auth;\n"],"names":["auth","role","ctx","next","session","sessionId","ExpiredSessionError","sessionRole","includes","InvalidAccessError"],"mappings":";;;;+BAmBA;;;eAAA;;;4BAnBwD;AAGxD,MAAMA,OAAO,CAACC;IACZ,OAAO,OAAOC;QACZ,MAAM,EAAEC,IAAI,EAAEC,OAAO,EAAE,GAAGF;QAE1B,IAAI,EAACE,oBAAAA,8BAAAA,QAASC,SAAS,GAAE;YACvB,MAAM,IAAIC,+BAAmB;QAC/B;QAEA,IAAIL,QAAQG,QAAQG,WAAW,KAAKN,QAAQ,CAACA,KAAKO,QAAQ,CAACJ,QAAQG,WAAW,GAAG;YAC/E,MAAM,IAAIE,8BAAkB;QAC9B;QAEAN;IACF;AACF;MAEA,WAAeH"}