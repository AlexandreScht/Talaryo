{"version":3,"sources":["../../src/middlewares/validator.ts"],"sourcesContent":["import { InvalidArgumentError, ServerException } from '@/exceptions';\nimport { ctx, validators } from '@/interfaces/request';\nimport * as yup from 'yup';\n\nconst validator = ({ body, params, query }: validators) => {\n  const validator = yup.object().shape({\n    ...(body ? { body: yup.object().shape(body) } : {}),\n    ...(query ? { query: yup.object().shape(query) } : {}),\n    ...(params ? { params: yup.object().shape(params) } : {}),\n  });\n\n  return async (ctx: ctx) => {\n    const { req, next } = ctx;\n\n    try {\n      const { body, params, query } = await validator.validate(\n        {\n          body: req.body,\n          params: req.params,\n          query: req.query,\n        },\n        { abortEarly: false },\n      );\n\n      ctx.locals = {\n        body,\n        params,\n        query,\n      };\n      await next();\n    } catch (err) {\n      if (err instanceof yup.ValidationError) {\n        throw new InvalidArgumentError(err.errors);\n      }\n\n      throw new ServerException();\n    }\n  };\n};\n\nexport default validator;\n"],"names":["validator","body","params","query","yup","object","shape","ctx","req","next","validate","abortEarly","locals","err","ValidationError","InvalidArgumentError","errors","ServerException"],"mappings":";;;;+BAwCA;;;eAAA;;;4BAxCsD;6DAEjC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAErB,MAAMA,YAAY,CAAC,EAAEC,IAAI,EAAEC,MAAM,EAAEC,KAAK,EAAc;IACpD,MAAMH,YAAYI,KAAIC,MAAM,GAAGC,KAAK,CAAC,mBAC/BL,OAAO;QAAEA,MAAMG,KAAIC,MAAM,GAAGC,KAAK,CAACL;IAAM,IAAI,CAAC,GAC7CE,QAAQ;QAAEA,OAAOC,KAAIC,MAAM,GAAGC,KAAK,CAACH;IAAO,IAAI,CAAC,GAChDD,SAAS;QAAEA,QAAQE,KAAIC,MAAM,GAAGC,KAAK,CAACJ;IAAQ,IAAI,CAAC;IAGzD,OAAO,OAAOK;QACZ,MAAM,EAAEC,GAAG,EAAEC,IAAI,EAAE,GAAGF;QAEtB,IAAI;YACF,MAAM,EAAEN,IAAI,EAAEC,MAAM,EAAEC,KAAK,EAAE,GAAG,MAAMH,UAAUU,QAAQ,CACtD;gBACET,MAAMO,IAAIP,IAAI;gBACdC,QAAQM,IAAIN,MAAM;gBAClBC,OAAOK,IAAIL,KAAK;YAClB,GACA;gBAAEQ,YAAY;YAAM;YAGtBJ,IAAIK,MAAM,GAAG;gBACXX;gBACAC;gBACAC;YACF;YACA,MAAMM;QACR,EAAE,OAAOI,KAAK;YACZ,IAAIA,eAAeT,KAAIU,eAAe,EAAE;gBACtC,MAAM,IAAIC,gCAAoB,CAACF,IAAIG,MAAM;YAC3C;YAEA,MAAM,IAAIC,2BAAe;QAC3B;IACF;AACF;MAEA,WAAejB"}